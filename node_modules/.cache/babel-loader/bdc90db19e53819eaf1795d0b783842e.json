{"remainingRequest":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/babel-loader/lib/index.js!/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fengwanjie/file/IdeaProjects/mall/mall-system/src/views/cart/CartItem.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/src/views/cart/CartItem.vue","mtime":1677682822548},{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/babel.config.js","mtime":1677682822494},{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHJlcXVlc3QgZnJvbSAnLi4vLi4vdXRpbHMvcmVxdWVzdCc7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbnVtOiAxLAogICAgICB2aXNpYmxlOiBmYWxzZQogICAgfTsKICB9LAoKICBtZXRob2RzOiB7CiAgICBoYW5kbGVDaGFuZ2UodmFsdWUpIHsKICAgICAgcmVxdWVzdC5wYXRjaCgnL2NhcnQvJyArIHRoaXMuY2FydFByb2R1Y3QuY2FydElkLCB7CiAgICAgICAgY291bnQ6IHZhbHVlCiAgICAgIH0pLnRoZW4ocmVzID0+IHsvLyBjb25zb2xlLmxvZygn5L+u5pS55oiQ5YqfJykKICAgICAgfSkuY2F0Y2goZXJyID0+IHsKICAgICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgICB9KTsKICAgICAgbGV0IHByaWNlID0gdGhpcy5udW0gKiB0aGlzLmNhcnRQcm9kdWN0LnByb2R1Y3RQcmljZSAqIHRoaXMuY2FydFByb2R1Y3QuZGlzY291bnQ7CiAgICAgIGxldCBkaXNjb3VudEFtb3VudCA9IHRoaXMubnVtICogdGhpcy5jYXJ0UHJvZHVjdC5wcm9kdWN0UHJpY2U7CiAgICAgIHRoaXMuJGVtaXQoJ3JlbG9hZCcsIHRoaXMuY2FydFByb2R1Y3QuY2FydElkLCB0aGlzLmNhcnRQcm9kdWN0LnByb2R1Y3RJZCwgdmFsdWUsIHByaWNlLCBkaXNjb3VudEFtb3VudCk7CiAgICB9LAoKICAgIGRlbGV0ZUNhcnRJdGVtKCkgewogICAgICB0aGlzLnZpc2libGUgPSBmYWxzZTsKICAgICAgbGV0IGNJZCA9IHRoaXMuY2FydFByb2R1Y3QuY2FydElkOwogICAgICByZXF1ZXN0LmRlbGV0ZSgnL2NhcnQvJyArIGNJZCkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuY29kZSA9PSAnMCcpIHsKICAgICAgICAgIC8vIOWIoOmZpOaIkOWKnwogICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgIG1lc3NhZ2U6IHJlcy5tc2csCiAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgZHVyYXRpb246IDEwMDAKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy4kZW1pdCgncmVsb2FkMicpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfliKDpmaTlpLHotKXvvIHmnI3liqHlmajplJnor6/vvIEnKTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGVyciA9PiB7CiAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgfSk7CiAgICB9LAoKICAgIHRvRGV0YWlscygpIHsKICAgICAgLy8g54K55Ye7IENhcnRJdGVtIOe7hOS7tu+8jOmAmui/h+i3r+eUseS8oOmAkuWVhuWTgWlk57uZRHRhaWxz57uE5Lu277yM54S25ZCO5Y+R6LW36K+35rGC44CCCiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICBwYXRoOiAnL2RldGFpbHMnLAogICAgICAgIHF1ZXJ5OiB7CiAgICAgICAgICBpZDogdGhpcy5jYXJ0UHJvZHVjdC5wcm9kdWN0SWQKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICB0b0NoZWNrb3V0KGUpIHsKICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgdGhpcy5jYXJ0UHJvZHVjdC5jb3VudCA9IDE7CiAgICAgIGxldCBvYmogPSB7CiAgICAgICAgdG90YWw6IDEsCiAgICAgICAgbW9uZXk6IHRoaXMuY2FydFByb2R1Y3QucHJvZHVjdFByaWNlICogdGhpcy5jYXJ0UHJvZHVjdC5kaXNjb3VudCwKICAgICAgICBjYXJ0UHJvZHVjdHM6IFt0aGlzLmNhcnRQcm9kdWN0XQogICAgICB9OwogICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdjaGVja291dCcsIEpTT04uc3RyaW5naWZ5KG9iaikpOwogICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnL2NoZWNrb3V0Jyk7CiAgICB9CgogIH0sCiAgcHJvcHM6IHsKICAgIGNhcnRQcm9kdWN0OiB7CiAgICAgIHR5cGU6IE9iamVjdAogICAgfQogIH0sCgogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLm51bSA9IHRoaXMuY2FydFByb2R1Y3QuY291bnQ7CiAgfQoKfTs="},{"version":3,"mappings":"AA8CA;AACA;EACAA;IACA;MACAC,MADA;MAEAC;IAFA;EAIA,CANA;;EAOAC;IACAC;MACAC,QACAC,KADA,CACA,kCADA,EACA;QACAC;MADA,CADA,EAIAC,IAJA,CAIAC,QACA;MACA,CANA,EAOAC,KAPA,CAOAC;QACAC;MACA,CATA;MAUA,YACA,oEADA;MAEA;MACA,WACA,QADA,EAEA,uBAFA,EAGA,0BAHA,EAIAC,KAJA,EAKAC,KALA,EAMAC,cANA;IAQA,CAvBA;;IAwBAC;MACA;MACA;MACAX,QACAY,MADA,CACA,cADA,EAEAT,IAFA,CAEAC;QACA;UACA;UACA;YACAS,gBADA;YAEAC,eAFA;YAGAC;UAHA;UAKA;QACA,CARA,MAQA;UACA;QACA;MACA,CAdA,EAeAV,KAfA,CAeAC;QACAC;MACA,CAjBA;IAkBA,CA7CA;;IA8CAS;MACA;MACA;QACAC,gBADA;QAEAC;UACAC;QADA;MAFA;IAMA,CAtDA;;IAuDAC;MACAC;MACA;MACA;QACAC,QADA;QAEAC,gEAFA;QAGAC;MAHA;MAKAC;MACA;IACA;;EAjEA,CAPA;EA0EAC;IACAC;MACAb;IADA;EADA,CA1EA;;EA+EAc;IACA;EACA;;AAjFA","names":["data","num","visible","methods","handleChange","request","patch","count","then","res","catch","err","console","value","price","discountAmount","deleteCartItem","delete","message","type","duration","toDetails","path","query","id","toCheckout","e","total","money","cartProducts","sessionStorage","props","cartProduct","created"],"sourceRoot":"src/views/cart","sources":["CartItem.vue"],"sourcesContent":["<template>\r\n  <el-row type=\"flex\" class=\"cart-item-bd\">\r\n    <el-col :span=\"5\">\r\n      <img :src=\"cartProduct.imgSrc\" alt=\"\" class=\"image\" />\r\n    </el-col>\r\n    <el-col :span=\"4\"> {{ cartProduct.productName }} </el-col>\r\n    <el-col :span=\"3\">￥{{ cartProduct.productPrice }}</el-col>\r\n    <el-col :span=\"5\">\r\n      <el-input-number\r\n        v-model=\"num\"\r\n        controls-position=\"right\"\r\n        style=\"width: 80%\"\r\n        @change=\"handleChange\"\r\n        :min=\"1\"\r\n        :max=\"999\"\r\n      ></el-input-number>\r\n    </el-col>\r\n    <el-col :span=\"3\"\r\n      >￥{{ (cartProduct.productPrice * this.num).toFixed(2) }}</el-col\r\n    >\r\n    <el-col :span=\"5\">\r\n      <el-popover placement=\"top\" width=\"160\" v-model=\"visible\">\r\n        <p>确定从收藏夹移出该商品吗？</p>\r\n        <div style=\"text-align: right; margin: 0\">\r\n          <el-button size=\"mini\" type=\"text\" @click=\"visible = false\"\r\n            >取消</el-button\r\n          >\r\n          <el-button type=\"primary\" size=\"mini\" @click=\"deleteCartItem\"\r\n            >确定</el-button\r\n          >\r\n        </div>\r\n      </el-popover>\r\n      <el-button @click=\"visible = true\" type=\"danger\" size=\"small\" plain\r\n        >删除</el-button\r\n      >\r\n      <el-button size=\"small\" type=\"primary\" @click=\"toDetails\" plain\r\n        >查看</el-button\r\n      >\r\n      <el-button size=\"small\" type=\"primary\" plain @click=\"toCheckout\"\r\n        >购买</el-button\r\n      >\r\n    </el-col>\r\n  </el-row>\r\n</template>\r\n\r\n<script>\r\nimport request from '../../utils/request'\r\nexport default {\r\n  data() {\r\n    return {\r\n      num: 1,\r\n      visible: false\r\n    }\r\n  },\r\n  methods: {\r\n    handleChange(value) {\r\n      request\r\n        .patch('/cart/' + this.cartProduct.cartId, {\r\n          count: value\r\n        })\r\n        .then((res) => {\r\n          // console.log('修改成功')\r\n        })\r\n        .catch((err) => {\r\n          console.log(err)\r\n        })\r\n      let price =\r\n        this.num * this.cartProduct.productPrice * this.cartProduct.discount\r\n      let discountAmount = this.num * this.cartProduct.productPrice\r\n      this.$emit(\r\n        'reload',\r\n        this.cartProduct.cartId,\r\n        this.cartProduct.productId,\r\n        value,\r\n        price,\r\n        discountAmount\r\n      )\r\n    },\r\n    deleteCartItem() {\r\n      this.visible = false\r\n      let cId = this.cartProduct.cartId\r\n      request\r\n        .delete('/cart/' + cId)\r\n        .then((res) => {\r\n          if (res.code == '0') {\r\n            // 删除成功\r\n            this.$message({\r\n              message: res.msg,\r\n              type: 'success',\r\n              duration: 1000\r\n            })\r\n            this.$emit('reload2')\r\n          } else {\r\n            this.$message.error('删除失败！服务器错误！')\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.log(err)\r\n        })\r\n    },\r\n    toDetails() {\r\n      // 点击 CartItem 组件，通过路由传递商品id给Dtails组件，然后发起请求。\r\n      this.$router.push({\r\n        path: '/details',\r\n        query: {\r\n          id: this.cartProduct.productId\r\n        }\r\n      })\r\n    },\r\n    toCheckout(e) {\r\n      e.stopPropagation()\r\n      this.cartProduct.count = 1\r\n      let obj = {\r\n        total: 1,\r\n        money: this.cartProduct.productPrice * this.cartProduct.discount,\r\n        cartProducts: [this.cartProduct]\r\n      }\r\n      sessionStorage.setItem('checkout', JSON.stringify(obj))\r\n      this.$router.push('/checkout')\r\n    }\r\n  },\r\n  props: {\r\n    cartProduct: {\r\n      type: Object\r\n    }\r\n  },\r\n  created() {\r\n    this.num = this.cartProduct.count\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.cart-item-bd {\r\n  padding: 10px;\r\n  border-bottom: 1px solid rgba(204, 204, 204, 0.5);\r\n  height: 150px;\r\n  line-height: 140px;\r\n  /* line-height: 100%; */\r\n}\r\n.image {\r\n  /* width: 70%; */\r\n  height: 80%;\r\n  margin: 5% 10%;\r\n  box-shadow: rgba(9, 30, 66, 0.25) 0px 4px 8px -2px,\r\n    rgba(9, 30, 66, 0.08) 0px 0px 0px 1px;\r\n}\r\n</style>"]}]}