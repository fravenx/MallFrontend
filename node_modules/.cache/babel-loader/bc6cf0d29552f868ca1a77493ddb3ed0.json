{"remainingRequest":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/babel-loader/lib/index.js!/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fengwanjie/file/IdeaProjects/mall/mall-system/src/pages/shop/products/Product.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/src/pages/shop/products/Product.vue","mtime":1677682822547},{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/babel.config.js","mtime":1677682822494},{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHJlcXVlc3QgZnJvbSAnLi4vLi4vLi4vdXRpbHMvcmVxdWVzdCc7Cgpjb25zdCBTdWJIZWFkZXIgPSAoKSA9PiBpbXBvcnQoJy4uLy4uL2NvbXBvbmVudHMvU3ViSGVhZGVyLnZ1ZScpOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIFN1YkhlYWRlcgogIH0sCiAgbmFtZTogJ0hvbWUnLAoKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZm9ybToge30sCiAgICAgIGRpYWxvZ0Zvcm1WaXNpYmxlOiBmYWxzZSwKICAgICAgZGlhbG9nRm9ybVZpc2libGUyOiBmYWxzZSwKICAgICAgLy8gcGFnZVNpemXmmK/ooajnpLrkuIDpobXmnIDlpJrlj6/ku6Xoo4Xlh6DmnaHmlbDmja4KICAgICAgcGFnZVNpemU6IDEwLAogICAgICAvLyDooajnpLror7fmsYLnrKzlh6DpobXmlbDmja4KICAgICAgcGFnZU51bTogMSwKICAgICAgLy8g5p+l6K+i5YWz6ZSu5a2XCiAgICAgIGtleTogJycsCiAgICAgIC8vIOaAu+WFseWHoOadoeaVsOaNrgogICAgICB0b3RhbDogMCwKICAgICAgdGFibGVEYXRhOiBbXSwKICAgICAgb3B0aW9uczogW10sCiAgICAgIHZhbHVlOiAnJywKICAgICAgdGltZXI6IG51bGwsCiAgICAgIHVJZDogc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgndXNlcklkJykKICAgIH07CiAgfSwKCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMubG9hZCgpOwogICAgcmVxdWVzdC5nZXQoJy9jYXRlZ29yeS9hbGwnKS50aGVuKHJlcyA9PiB7CiAgICAgIHRoaXMub3B0aW9ucyA9IFtdOwogICAgICByZXMuZm9yRWFjaChjID0+IHsKICAgICAgICBsZXQgW3ZhbHVlLCBsYWJlbF0gPSBbYy5jYXRlZ29yeUlkLCBjLmNhdGVnb3J5TmFtZV07CiAgICAgICAgbGV0IGNhdGVnb3J5ID0gewogICAgICAgICAgdmFsdWUsCiAgICAgICAgICBsYWJlbAogICAgICAgIH07CiAgICAgICAgdGhpcy5vcHRpb25zLnB1c2goY2F0ZWdvcnkpOwogICAgICB9KTsKICAgIH0pLmNhdGNoKGVyciA9PiB7CiAgICAgIGNvbnNvbGUubG9nKGVycik7CiAgICB9KTsKICB9LAoKICBtZXRob2RzOiB7CiAgICAvLyDliLfmlrDooajmoLwKICAgIHJlZnJlc2hUYWJsZSgpIHsKICAgICAgdGhpcy5sb2FkKCk7CiAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgIG1lc3NhZ2U6ICfliLfmlrDmiJDlip/vvIEnLAogICAgICAgIHR5cGU6ICdzdWNjZXNzJwogICAgICB9KTsKICAgIH0sCgogICAgLy8g5Yig6ZmkCiAgICBkZWxldGVSb3coaW5kZXgsIHJvd3MpIHsKICAgICAgdGhpcy4kY29uZmlybSgn5q2k5pON5L2c5bCG5rC45LmF5Yig6ZmkLCDmmK/lkKbnu6fnu60/JywgJ+aPkOekuicsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgIGxldCBkZWxldGVJZCA9IHJvd3NbaW5kZXhdLnByb2R1Y3RJZDsKICAgICAgICByb3dzLnNwbGljZShpbmRleCwgMSk7CiAgICAgICAgcmVxdWVzdC5kZWxldGUoJy9wcm9kdWN0LycgKyBkZWxldGVJZCkudGhlbihyZXMgPT4gewogICAgICAgICAgaWYgKHJlcy5jb2RlID09PSAnMCcpIHsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgbWVzc2FnZTogJ+WIoOmZpOaIkOWKn++8gScsCiAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICB0eXBlOiAnaW5mbycsCiAgICAgICAgICBtZXNzYWdlOiAn5bey5Y+W5raI5Yig6ZmkJwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCgogICAgLy8g57yW6L6RCiAgICBoYW5kbGVFZGl0KHJvdykgewogICAgICB0aGlzLmZvcm0gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHJvdykpOwogICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gdHJ1ZTsKICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgIHRoaXMuJHJlZnNbJ3VwbG9hZCddLmNsZWFyRmlsZXMoKTsKICAgICAgfSk7CiAgICB9LAoKICAgIC8vIOafpeeci+mUgOWUruS/oeaBrwogICAgc2hvd1NhbGUocm93KSB7CiAgICAgIHRoaXMuZm9ybSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocm93KSk7CiAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUyID0gdHJ1ZTsKICAgIH0sCgogICAgc2VhcmNoKCkgewogICAgICB0aGlzLmxvYWQoKTsKICAgIH0sCgogICAgaGFuZGxlU2l6ZUNoYW5nZSh2YWwpIHsKICAgICAgLy8gY29uc29sZS5sb2coYOavj+mhtSAke3ZhbH0g5p2hYCkKICAgICAgdGhpcy5wYWdlU2l6ZSA9IHZhbDsKICAgICAgdGhpcy5sb2FkKCk7CiAgICB9LAoKICAgIGhhbmRsZUN1cnJlbnRDaGFuZ2UodmFsKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKGDlvZPliY3pobU6ICR7dmFsfWApCiAgICAgIHRoaXMucGFnZU51bSA9IHZhbDsKICAgICAgdGhpcy5sb2FkKCk7CiAgICB9LAoKICAgIC8vIOWKoOi9veihqOagvOaVsOaNrgogICAgbG9hZCgpIHsKICAgICAgbGV0IHVJZCA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3VzZXJJZCcpOwogICAgICByZXF1ZXN0LmdldCgnL3Byb2R1Y3Qvc2hvcCcsIHsKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIHBhZ2VOdW06IHRoaXMucGFnZU51bSwKICAgICAgICAgIHBhZ2VTaXplOiB0aGlzLnBhZ2VTaXplLAogICAgICAgICAga2V5OiB0aGlzLmtleSwKICAgICAgICAgIG93bmVySWQ6IHVJZAogICAgICAgIH0KICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgIHRoaXMudG90YWwgPSByZXMuZGF0YS50b3RhbDsKICAgICAgICB0aGlzLnRhYmxlRGF0YSA9IFtdOwogICAgICAgIHJlcy5kYXRhLmRhdGEuZm9yRWFjaCgoZSwgaSkgPT4gewogICAgICAgICAgZS5pbmRleCA9IGkgKyAxOwogICAgICAgICAgdGhpcy50YWJsZURhdGEucHVzaChlKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAoKICAgIGFkZFByb2R1Y3QoKSB7CiAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSB0cnVlOwogICAgICB0aGlzLmZvcm0gPSB7fTsgLy8g5riF56m65Y6f5paH5Lu25YaF5a65CgogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgdGhpcy4kcmVmc1sndXBsb2FkJ10uY2xlYXJGaWxlcygpOwogICAgICB9KTsKICAgIH0sCgogICAgdXBsb2FkU3VjY2VzcyhyZXMpIHsKICAgICAgLy8gY29uc29sZS5sb2cocmVzKQogICAgICB0aGlzLmZvcm0uaW1nU3JjID0gcmVzLmRhdGE7CiAgICB9LAoKICAgIGdldENhdGVnb3J5KHZhbCkgewogICAgICBsZXQgcmVzID0gJyc7CiAgICAgIHRoaXMub3B0aW9ucy5zb21lKGl0ZW0gPT4gewogICAgICAgIGlmICh2YWwgPT0gaXRlbS52YWx1ZSkgewogICAgICAgICAgcmVzID0gaXRlbS5sYWJlbDsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiByZXM7CiAgICB9LAoKICAgIGdldFNob3BJbmZvKCkgewogICAgICByZXR1cm4gcmVxdWVzdC5nZXQoJy9zaG9wLycgKyB0aGlzLnVJZCkudGhlbihyZXMgPT4gewogICAgICAgIHJldHVybiByZXM7CiAgICAgIH0pOwogICAgfSwKCiAgICBzYXZlKCkgewogICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmZvcm0pCiAgICAgIGlmICh0aGlzLmZvcm0ucHJvZHVjdElkKSB7CiAgICAgICAgLy8g6Iul5q2k6LCD5pWw5o2u5pyJaWTvvIzliJnov5vooYzmm7TmlrDmk43kvZzvvIzlkIzmraXmlbDmja7lupPvvIzov5vooYxQVVTor7fmsYIKICAgICAgICByZXF1ZXN0LnB1dCgnL3Byb2R1Y3QnLCB0aGlzLmZvcm0pLnRoZW4ocmVzID0+IHsKICAgICAgICAgIGlmIChyZXMuY29kZSA9PT0gJzAnKSB7CiAgICAgICAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgbWVzc2FnZTogJ+aBreWWnOS9oO+8jOS/ruaUueaIkOWKn++8gScsCiAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgbWVzc2FnZTogJ+S/ruaUueWksei0pe+8jOivt+iBlOezu+euoeeQhuWRmO+8gScsCiAgICAgICAgICAgICAgdHlwZTogJ2ZhaWxlZCcKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSkuY2F0Y2goZXJyID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgICAvLyDliLfmlrDooajmoLzmlbDmja4KICAgICAgICAgIHRoaXMubG9hZCgpOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZ2V0U2hvcEluZm8oKS50aGVuKHJlczEgPT4gewogICAgICAgICAgdGhpcy5mb3JtLnNob3BJZCA9IHJlczEuZGF0YS5zaG9wSWQ7CiAgICAgICAgICB0aGlzLmZvcm0uc29sZCA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqICg1MDAgLSAxMDApKSArIDEwMDsKICAgICAgICAgIHJlcXVlc3QucG9zdCgnL3Byb2R1Y3QnLCB0aGlzLmZvcm0pLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgaWYgKHJlcy5jb2RlID09PSAnMCcpIHsKICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHJlcy5tc2csCiAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgICAgICBkdXJhdGlvbjogMTAwMAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTsKICAgICAgICAgICAgICB0aGlzLnRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLmxvYWQoKTsKICAgICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkuY2F0Y2goZXJyID0+IHsKICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgICAgICAvLyDliLfmlrDooajmoLzmlbDmja4KICAgICAgICAgICAgdGhpcy5sb2FkKCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQoKICB9Cn07"},{"version":3,"mappings":"AA0MA;;AACA;;AAEA;EACAA;IACAC;EADA,CADA;EAIAC,YAJA;;EAKAC;IACA;MACAC,QADA;MAEAC,wBAFA;MAGAC,yBAHA;MAIA;MACAC,YALA;MAMA;MACAC,UAPA;MAQA;MACAC,OATA;MAUA;MACAC,QAXA;MAYAC,aAZA;MAaAC,WAbA;MAcAC,SAdA;MAeAC,WAfA;MAgBAC;IAhBA;EAkBA,CAxBA;;EAyBAC;IACA;IACAC,QACAC,GADA,CACA,eADA,EAEAC,IAFA,CAEAC;MACA;MACAA;QACA;QACA;UAAAP;UAAAQ;QAAA;QACA;MACA,CAJA;IAKA,CATA,EAUAC,KAVA,CAUAC;MACAC;IACA,CAZA;EAaA,CAxCA;;EAyCAC;IACA;IACAC;MACA;MACA;QACAC,gBADA;QAEAC;MAFA;IAIA,CARA;;IASA;IACAC;MACA;QACAC,uBADA;QAEAC,sBAFA;QAGAH;MAHA,GAKAT,IALA,CAKA;QACA;QACAa;QACAf;UACA;YACA;cACAU,gBADA;cAEAC;YAFA;UAIA;QACA,CAPA;MAQA,CAhBA,EAiBAN,KAjBA,CAiBA;QACA;UACAM,YADA;UAEAD;QAFA;MAIA,CAtBA;IAuBA,CAlCA;;IAmCA;IACAM;MACA;MACA;MAEA;QACA;MACA,CAFA;IAGA,CA3CA;;IA4CA;IACAC;MACA;MACA;IACA,CAhDA;;IAiDAC;MACA;IACA,CAnDA;;IAoDAC;MACA;MACA;MACA;IACA,CAxDA;;IAyDAC;MACA;MACA;MACA;IACA,CA7DA;;IA8DA;IACAC;MACA;MACArB,QACAC,GADA,CACA,eADA,EACA;QACAqB;UACA/B,qBADA;UAEAD,uBAFA;UAGAE,aAHA;UAIA+B;QAJA;MADA,CADA,EASArB,IATA,CASAC;QACA;QACA;QACAA;UACAqB;UACA;QACA,CAHA;MAIA,CAhBA;IAiBA,CAlFA;;IAmFAC;MACA;MACA,eAFA,CAGA;;MACA;QACA;MACA,CAFA;IAGA,CA1FA;;IA2FAC;MACA;MACA;IACA,CA9FA;;IA+FAC;MACA;MACA;QACA;UACAxB;UACA;QACA;MACA,CALA;MAMA;IACA,CAxGA;;IAyGAyB;MACA;QACA;MACA,CAFA;IAGA,CA7GA;;IA8GAC;MACA;MACA;QACA;QACA7B,QACA8B,GADA,CACA,UADA,EACA,SADA,EAEA5B,IAFA,CAEAC;UACA;YACA;YACA;cACAO,oBADA;cAEAC;YAFA;UAIA,CANA,MAMA;YACA;cACAD,uBADA;cAEAC;YAFA;UAIA;QACA,CAfA,EAgBAN,KAhBA,CAgBAC;UACAC;QACA,CAlBA,EAmBAL,IAnBA,CAmBA;UACA;UACA;QACA,CAtBA;MAuBA,CAzBA,MAyBA;QACA;UACA;UACA;UACAF,QACA+B,IADA,CACA,UADA,EACA,SADA,EAEA7B,IAFA,CAEAC;YACA;cACA;gBACAO,gBADA;gBAEAC,eAFA;gBAGAqB;cAHA;cAKAC;cACA;gBACA;gBACA;cACA,CAHA,EAGA,IAHA;YAIA;UACA,CAfA,EAgBA5B,KAhBA,CAgBAC;YACAC;UACA,CAlBA,EAmBAL,IAnBA,CAmBA;YACA;YACA;UACA,CAtBA;QAuBA,CA1BA;MA2BA;IACA;;EAtKA;AAzCA","names":["components","SubHeader","name","data","form","dialogFormVisible","dialogFormVisible2","pageSize","pageNum","key","total","tableData","options","value","timer","uId","created","request","get","then","res","label","catch","err","console","methods","refreshTable","message","type","deleteRow","confirmButtonText","cancelButtonText","rows","handleEdit","showSale","search","handleSizeChange","handleCurrentChange","load","params","ownerId","e","addProduct","uploadSuccess","getCategory","getShopInfo","save","put","post","duration","clearTimeout"],"sourceRoot":"src/pages/shop/products","sources":["Product.vue"],"sourcesContent":["<template>\r\n  <el-col class=\"container\">\r\n    <SubHeader>\r\n      <template v-slot> 管理本店所有商品 </template>\r\n    </SubHeader>\r\n    <el-form @submit.native.prevent>\r\n      <el-input\r\n        v-model=\"key\"\r\n        placeholder=\"请输入内容\"\r\n        style=\"margin-top: 10px; width: 250px\"\r\n        clearable\r\n      ></el-input>\r\n      <el-button type=\"primary\" style=\"margin-left: 10px\" @click=\"search\"\r\n        >查询</el-button\r\n      >\r\n      <el-button type=\"primary\" @click=\"addProduct\">新增</el-button>\r\n      <el-button type=\"primary\" @click=\"refreshTable\">刷新</el-button>\r\n    </el-form>\r\n\r\n    <el-table :data=\"tableData\" style=\"margin-top: 10px\" border stripe>\r\n      <el-table-column\r\n        prop=\"index\"\r\n        label=\"序号\"\r\n        width=\"70px\"\r\n        align=\"center\"\r\n      ></el-table-column>\r\n      <el-table-column\r\n        prop=\"productName\"\r\n        label=\"商品名\"\r\n        width=\"80px\"\r\n        align=\"center\"\r\n      >\r\n      </el-table-column>\r\n      <el-table-column\r\n        prop=\"productPrice\"\r\n        sortable\r\n        label=\"单价\"\r\n        width=\"90px\"\r\n        align=\"center\"\r\n      >\r\n      </el-table-column>\r\n      <!-- <el-table-column prop=\"imgSrc\" label=\"封面\"> </el-table-column> -->\r\n      <el-table-column label=\"分类\" width=\"80px\" align=\"center\">\r\n        <template #default=\"scope\">\r\n          <div>{{ getCategory(scope.row.categoryId) }}</div>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"weight\" label=\"重量\" width=\"70px\" align=\"center\">\r\n      </el-table-column>\r\n      <el-table-column prop=\"discount\" label=\"折扣\" width=\"70px\" align=\"center\">\r\n      </el-table-column>\r\n      <el-table-column prop=\"left\" label=\"剩余\" width=\"70px\" align=\"center\">\r\n      </el-table-column>\r\n      <el-table-column label=\"封面\" align=\"center\">\r\n        <template #default=\"scope\">\r\n          <el-image\r\n            style=\"height: 100px\"\r\n            :src=\"scope.row.imgSrc\"\r\n            :preview-src-list=\"[scope.row.imgSrc]\"\r\n          >\r\n          </el-image>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"productDesc\" label=\"描述\" show-overflow-tooltip>\r\n      </el-table-column>\r\n\r\n      <el-table-column fixed=\"right\" label=\"操作\" align=\"center\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button\r\n            @click=\"handleEdit(scope.row)\"\r\n            type=\"primary\"\r\n            icon=\"el-icon-edit\"\r\n            circle\r\n            size=\"mini\"\r\n          ></el-button>\r\n          <el-tooltip content=\"查看商品销售信息\" placement=\"top\">\r\n            <el-button\r\n              @click=\"showSale(scope.row)\"\r\n              type=\"primary\"\r\n              icon=\"el-icon-info\"\r\n              circle\r\n              size=\"mini\"\r\n            ></el-button>\r\n          </el-tooltip>\r\n\r\n          <el-button\r\n            type=\"danger\"\r\n            icon=\"el-icon-delete\"\r\n            circle\r\n            size=\"mini\"\r\n            @click.native.prevent=\"deleteRow(scope.$index, tableData)\"\r\n          ></el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <el-pagination\r\n      @size-change=\"handleSizeChange\"\r\n      @current-change=\"handleCurrentChange\"\r\n      :page-sizes=\"[5, 10, 100]\"\r\n      :page-size=\"pageSize\"\r\n      layout=\"total, sizes, prev, pager, next, jumper\"\r\n      :total=\"total\"\r\n      style=\"margin-top: 10px\"\r\n    >\r\n    </el-pagination>\r\n\r\n    <!-- 修改商品弹出 -->\r\n    <el-dialog\r\n      title=\"填写商品信息\"\r\n      :visible.sync=\"dialogFormVisible\"\r\n      class=\"add\"\r\n    >\r\n      <el-form ref=\"form\" :model=\"form\" label-width=\"60px\">\r\n        <el-row type=\"flex\">\r\n          <el-col>\r\n            <el-form-item label=\"商品名\" style=\"margin-bottom: 7px\">\r\n              <el-input\r\n                v-model=\"form.productName\"\r\n                style=\"width: 200px\"\r\n              ></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"单价\" style=\"margin-bottom: 7px\">\r\n              <el-input\r\n                v-model=\"form.productPrice\"\r\n                style=\"width: 200px\"\r\n              ></el-input>\r\n            </el-form-item>\r\n\r\n            <el-form-item label=\"分类\" style=\"margin-bottom: 7px\">\r\n              <el-select\r\n                v-model=\"form.categoryId\"\r\n                placeholder=\"请选择\"\r\n                style=\"width: 200px\"\r\n              >\r\n                <el-option\r\n                  v-for=\"item in options\"\r\n                  :key=\"item.value\"\r\n                  :label=\"item.label\"\r\n                  :value=\"item.value\"\r\n                >\r\n                </el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n            <el-form-item label=\"重量\" style=\"margin-bottom: 7px\">\r\n              <el-input v-model=\"form.weight\" style=\"width: 200px\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"描述\" style=\"margin-bottom: 7px\">\r\n              <el-input\r\n                type=\"textarea\"\r\n                v-model=\"form.productDesc\"\r\n                style=\"width: 200px\"\r\n                rows=\"6\"\r\n              ></el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col>\r\n            <el-form-item label=\"折扣\" style=\"margin-bottom: 7px\">\r\n              <el-input v-model=\"form.discount\" style=\"width: 200px\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"剩余\" style=\"margin-bottom: 7px\">\r\n              <el-input v-model=\"form.left\" style=\"width: 200px\"></el-input>\r\n            </el-form-item>\r\n\r\n            <el-form-item label=\"封面\">\r\n              <el-upload\r\n                :action=\"\r\n                  'http://' +\r\n                  this.$root.$children[0]._data.filesUploadUrl +\r\n                  '/files/upload'\r\n                \"\r\n                :on-success=\"uploadSuccess\"\r\n                ref=\"upload\"\r\n              >\r\n                <el-button size=\"small\" type=\"primary\">点击上传</el-button>\r\n              </el-upload>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"save\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n    <!-- 查看商品销售信息弹出 -->\r\n    <el-dialog title=\"商品销售情况\" :visible.sync=\"dialogFormVisible2\">\r\n      <el-descriptions :column=\"2\" :border=\"true\" direction=\"vertical\">\r\n        <el-descriptions-item label=\"已售量\">{{\r\n          form.sold\r\n        }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"商品评分\">{{\r\n          form.rate\r\n        }}</el-descriptions-item>\r\n      </el-descriptions>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogFormVisible2 = false\">取 消</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </el-col>\r\n</template>\r\n\r\n<script>\r\nimport request from '../../../utils/request'\r\nconst SubHeader = () => import('../../components/SubHeader.vue')\r\n\r\nexport default {\r\n  components: {\r\n    SubHeader\r\n  },\r\n  name: 'Home',\r\n  data() {\r\n    return {\r\n      form: {},\r\n      dialogFormVisible: false,\r\n      dialogFormVisible2: false,\r\n      // pageSize是表示一页最多可以装几条数据\r\n      pageSize: 10,\r\n      // 表示请求第几页数据\r\n      pageNum: 1,\r\n      // 查询关键字\r\n      key: '',\r\n      // 总共几条数据\r\n      total: 0,\r\n      tableData: [],\r\n      options: [],\r\n      value: '',\r\n      timer: null,\r\n      uId: sessionStorage.getItem('userId')\r\n    }\r\n  },\r\n  created() {\r\n    this.load()\r\n    request\r\n      .get('/category/all')\r\n      .then((res) => {\r\n        this.options = []\r\n        res.forEach((c) => {\r\n          let [value, label] = [c.categoryId, c.categoryName]\r\n          let category = { value, label }\r\n          this.options.push(category)\r\n        })\r\n      })\r\n      .catch((err) => {\r\n        console.log(err)\r\n      })\r\n  },\r\n  methods: {\r\n    // 刷新表格\r\n    refreshTable() {\r\n      this.load()\r\n      this.$message({\r\n        message: '刷新成功！',\r\n        type: 'success'\r\n      })\r\n    },\r\n    // 删除\r\n    deleteRow(index, rows) {\r\n      this.$confirm('此操作将永久删除, 是否继续?', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      })\r\n        .then(() => {\r\n          let deleteId = rows[index].productId\r\n          rows.splice(index, 1)\r\n          request.delete('/product/' + deleteId).then((res) => {\r\n            if (res.code === '0') {\r\n              this.$message({\r\n                message: '删除成功！',\r\n                type: 'success'\r\n              })\r\n            }\r\n          })\r\n        })\r\n        .catch(() => {\r\n          this.$message({\r\n            type: 'info',\r\n            message: '已取消删除'\r\n          })\r\n        })\r\n    },\r\n    // 编辑\r\n    handleEdit(row) {\r\n      this.form = JSON.parse(JSON.stringify(row))\r\n      this.dialogFormVisible = true\r\n\r\n      this.$nextTick(() => {\r\n        this.$refs['upload'].clearFiles()\r\n      })\r\n    },\r\n    // 查看销售信息\r\n    showSale(row) {\r\n      this.form = JSON.parse(JSON.stringify(row))\r\n      this.dialogFormVisible2 = true\r\n    },\r\n    search() {\r\n      this.load()\r\n    },\r\n    handleSizeChange(val) {\r\n      // console.log(`每页 ${val} 条`)\r\n      this.pageSize = val\r\n      this.load()\r\n    },\r\n    handleCurrentChange(val) {\r\n      // console.log(`当前页: ${val}`)\r\n      this.pageNum = val\r\n      this.load()\r\n    },\r\n    // 加载表格数据\r\n    load() {\r\n      let uId = sessionStorage.getItem('userId')\r\n      request\r\n        .get('/product/shop', {\r\n          params: {\r\n            pageNum: this.pageNum,\r\n            pageSize: this.pageSize,\r\n            key: this.key,\r\n            ownerId: uId\r\n          }\r\n        })\r\n        .then((res) => {\r\n          this.total = res.data.total\r\n          this.tableData = []\r\n          res.data.data.forEach((e, i) => {\r\n            e.index = i + 1\r\n            this.tableData.push(e)\r\n          })\r\n        })\r\n    },\r\n    addProduct() {\r\n      this.dialogFormVisible = true\r\n      this.form = {}\r\n      // 清空原文件内容\r\n      this.$nextTick(() => {\r\n        this.$refs['upload'].clearFiles()\r\n      })\r\n    },\r\n    uploadSuccess(res) {\r\n      // console.log(res)\r\n      this.form.imgSrc = res.data\r\n    },\r\n    getCategory(val) {\r\n      let res = ''\r\n      this.options.some((item) => {\r\n        if (val == item.value) {\r\n          res = item.label\r\n          return true\r\n        }\r\n      })\r\n      return res\r\n    },\r\n    getShopInfo() {\r\n      return request.get('/shop/' + this.uId).then((res) => {\r\n        return res\r\n      })\r\n    },\r\n    save() {\r\n      // console.log(this.form)\r\n      if (this.form.productId) {\r\n        // 若此调数据有id，则进行更新操作，同步数据库，进行PUT请求\r\n        request\r\n          .put('/product', this.form)\r\n          .then((res) => {\r\n            if (res.code === '0') {\r\n              this.dialogFormVisible = false\r\n              this.$message({\r\n                message: '恭喜你，修改成功！',\r\n                type: 'success'\r\n              })\r\n            } else {\r\n              this.$message({\r\n                message: '修改失败，请联系管理员！',\r\n                type: 'failed'\r\n              })\r\n            }\r\n          })\r\n          .catch((err) => {\r\n            console.log(err)\r\n          })\r\n          .then(() => {\r\n            // 刷新表格数据\r\n            this.load()\r\n          })\r\n      } else {\r\n        this.getShopInfo().then((res1) => {\r\n          this.form.shopId = res1.data.shopId\r\n          this.form.sold = Math.round(Math.random() * (500 - 100)) + 100\r\n          request\r\n            .post('/product', this.form)\r\n            .then((res) => {\r\n              if (res.code === '0') {\r\n                this.$message({\r\n                  message: res.msg,\r\n                  type: 'success',\r\n                  duration: 1000\r\n                })\r\n                clearTimeout(this.timer)\r\n                this.timer = setTimeout(() => {\r\n                  this.dialogFormVisible = false\r\n                  this.load()\r\n                }, 1000)\r\n              }\r\n            })\r\n            .catch((err) => {\r\n              console.log(err)\r\n            })\r\n            .then(() => {\r\n              // 刷新表格数据\r\n              this.load()\r\n            })\r\n        })\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.container {\r\n  padding: 20px;\r\n  box-shadow: rgba(60, 64, 67, 0.3) 0px 1px 2px 0px,\r\n    rgba(60, 64, 67, 0.15) 0px 2px 6px 2px;\r\n  border-radius: 5px;\r\n}\r\n</style>"]}]}