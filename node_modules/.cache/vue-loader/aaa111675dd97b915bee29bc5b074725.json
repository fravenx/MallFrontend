{"remainingRequest":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fengwanjie/file/IdeaProjects/mall/mall-system/src/views/cart/CartItem.vue?vue&type=style&index=0&id=084a9fd8&scoped=true&lang=css&","dependencies":[{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/src/views/cart/CartItem.vue","mtime":1677682822548},{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1655715156000},{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouY2FydC1pdGVtLWJkIHsNCiAgcGFkZGluZzogMTBweDsNCiAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHJnYmEoMjA0LCAyMDQsIDIwNCwgMC41KTsNCiAgaGVpZ2h0OiAxNTBweDsNCiAgbGluZS1oZWlnaHQ6IDE0MHB4Ow0KICAvKiBsaW5lLWhlaWdodDogMTAwJTsgKi8NCn0NCi5pbWFnZSB7DQogIC8qIHdpZHRoOiA3MCU7ICovDQogIGhlaWdodDogODAlOw0KICBtYXJnaW46IDUlIDEwJTsNCiAgYm94LXNoYWRvdzogcmdiYSg5LCAzMCwgNjYsIDAuMjUpIDBweCA0cHggOHB4IC0ycHgsDQogICAgcmdiYSg5LCAzMCwgNjYsIDAuMDgpIDBweCAwcHggMHB4IDFweDsNCn0NCg=="},{"version":3,"sources":["CartItem.vue"],"names":[],"mappings":";AAqIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CartItem.vue","sourceRoot":"src/views/cart","sourcesContent":["<template>\r\n  <el-row type=\"flex\" class=\"cart-item-bd\">\r\n    <el-col :span=\"5\">\r\n      <img :src=\"cartProduct.imgSrc\" alt=\"\" class=\"image\" />\r\n    </el-col>\r\n    <el-col :span=\"4\"> {{ cartProduct.productName }} </el-col>\r\n    <el-col :span=\"3\">￥{{ cartProduct.productPrice }}</el-col>\r\n    <el-col :span=\"5\">\r\n      <el-input-number\r\n        v-model=\"num\"\r\n        controls-position=\"right\"\r\n        style=\"width: 80%\"\r\n        @change=\"handleChange\"\r\n        :min=\"1\"\r\n        :max=\"999\"\r\n      ></el-input-number>\r\n    </el-col>\r\n    <el-col :span=\"3\"\r\n      >￥{{ (cartProduct.productPrice * this.num).toFixed(2) }}</el-col\r\n    >\r\n    <el-col :span=\"5\">\r\n      <el-popover placement=\"top\" width=\"160\" v-model=\"visible\">\r\n        <p>确定从收藏夹移出该商品吗？</p>\r\n        <div style=\"text-align: right; margin: 0\">\r\n          <el-button size=\"mini\" type=\"text\" @click=\"visible = false\"\r\n            >取消</el-button\r\n          >\r\n          <el-button type=\"primary\" size=\"mini\" @click=\"deleteCartItem\"\r\n            >确定</el-button\r\n          >\r\n        </div>\r\n      </el-popover>\r\n      <el-button @click=\"visible = true\" type=\"danger\" size=\"small\" plain\r\n        >删除</el-button\r\n      >\r\n      <el-button size=\"small\" type=\"primary\" @click=\"toDetails\" plain\r\n        >查看</el-button\r\n      >\r\n      <el-button size=\"small\" type=\"primary\" plain @click=\"toCheckout\"\r\n        >购买</el-button\r\n      >\r\n    </el-col>\r\n  </el-row>\r\n</template>\r\n\r\n<script>\r\nimport request from '../../utils/request'\r\nexport default {\r\n  data() {\r\n    return {\r\n      num: 1,\r\n      visible: false\r\n    }\r\n  },\r\n  methods: {\r\n    handleChange(value) {\r\n      request\r\n        .patch('/cart/' + this.cartProduct.cartId, {\r\n          count: value\r\n        })\r\n        .then((res) => {\r\n          // console.log('修改成功')\r\n        })\r\n        .catch((err) => {\r\n          console.log(err)\r\n        })\r\n      let price =\r\n        this.num * this.cartProduct.productPrice * this.cartProduct.discount\r\n      let discountAmount = this.num * this.cartProduct.productPrice\r\n      this.$emit(\r\n        'reload',\r\n        this.cartProduct.cartId,\r\n        this.cartProduct.productId,\r\n        value,\r\n        price,\r\n        discountAmount\r\n      )\r\n    },\r\n    deleteCartItem() {\r\n      this.visible = false\r\n      let cId = this.cartProduct.cartId\r\n      request\r\n        .delete('/cart/' + cId)\r\n        .then((res) => {\r\n          if (res.code == '0') {\r\n            // 删除成功\r\n            this.$message({\r\n              message: res.msg,\r\n              type: 'success',\r\n              duration: 1000\r\n            })\r\n            this.$emit('reload2')\r\n          } else {\r\n            this.$message.error('删除失败！服务器错误！')\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.log(err)\r\n        })\r\n    },\r\n    toDetails() {\r\n      // 点击 CartItem 组件，通过路由传递商品id给Dtails组件，然后发起请求。\r\n      this.$router.push({\r\n        path: '/details',\r\n        query: {\r\n          id: this.cartProduct.productId\r\n        }\r\n      })\r\n    },\r\n    toCheckout(e) {\r\n      e.stopPropagation()\r\n      this.cartProduct.count = 1\r\n      let obj = {\r\n        total: 1,\r\n        money: this.cartProduct.productPrice * this.cartProduct.discount,\r\n        cartProducts: [this.cartProduct]\r\n      }\r\n      sessionStorage.setItem('checkout', JSON.stringify(obj))\r\n      this.$router.push('/checkout')\r\n    }\r\n  },\r\n  props: {\r\n    cartProduct: {\r\n      type: Object\r\n    }\r\n  },\r\n  created() {\r\n    this.num = this.cartProduct.count\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.cart-item-bd {\r\n  padding: 10px;\r\n  border-bottom: 1px solid rgba(204, 204, 204, 0.5);\r\n  height: 150px;\r\n  line-height: 140px;\r\n  /* line-height: 100%; */\r\n}\r\n.image {\r\n  /* width: 70%; */\r\n  height: 80%;\r\n  margin: 5% 10%;\r\n  box-shadow: rgba(9, 30, 66, 0.25) 0px 4px 8px -2px,\r\n    rgba(9, 30, 66, 0.08) 0px 0px 0px 1px;\r\n}\r\n</style>"]}]}