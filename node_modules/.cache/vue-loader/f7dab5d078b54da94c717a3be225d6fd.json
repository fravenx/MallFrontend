{"remainingRequest":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fengwanjie/file/IdeaProjects/mall/mall-system/src/views/cart/CartItem.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/src/views/cart/CartItem.vue","mtime":1677682822548},{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fengwanjie/file/IdeaProjects/mall/mall-system/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgcmVxdWVzdCBmcm9tICcuLi8uLi91dGlscy9yZXF1ZXN0Jw0KZXhwb3J0IGRlZmF1bHQgew0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBudW06IDEsDQogICAgICB2aXNpYmxlOiBmYWxzZQ0KICAgIH0NCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGhhbmRsZUNoYW5nZSh2YWx1ZSkgew0KICAgICAgcmVxdWVzdA0KICAgICAgICAucGF0Y2goJy9jYXJ0LycgKyB0aGlzLmNhcnRQcm9kdWN0LmNhcnRJZCwgew0KICAgICAgICAgIGNvdW50OiB2YWx1ZQ0KICAgICAgICB9KQ0KICAgICAgICAudGhlbigocmVzKSA9PiB7DQogICAgICAgICAgLy8gY29uc29sZS5sb2coJ+S/ruaUueaIkOWKnycpDQogICAgICAgIH0pDQogICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7DQogICAgICAgICAgY29uc29sZS5sb2coZXJyKQ0KICAgICAgICB9KQ0KICAgICAgbGV0IHByaWNlID0NCiAgICAgICAgdGhpcy5udW0gKiB0aGlzLmNhcnRQcm9kdWN0LnByb2R1Y3RQcmljZSAqIHRoaXMuY2FydFByb2R1Y3QuZGlzY291bnQNCiAgICAgIGxldCBkaXNjb3VudEFtb3VudCA9IHRoaXMubnVtICogdGhpcy5jYXJ0UHJvZHVjdC5wcm9kdWN0UHJpY2UNCiAgICAgIHRoaXMuJGVtaXQoDQogICAgICAgICdyZWxvYWQnLA0KICAgICAgICB0aGlzLmNhcnRQcm9kdWN0LmNhcnRJZCwNCiAgICAgICAgdGhpcy5jYXJ0UHJvZHVjdC5wcm9kdWN0SWQsDQogICAgICAgIHZhbHVlLA0KICAgICAgICBwcmljZSwNCiAgICAgICAgZGlzY291bnRBbW91bnQNCiAgICAgICkNCiAgICB9LA0KICAgIGRlbGV0ZUNhcnRJdGVtKCkgew0KICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2UNCiAgICAgIGxldCBjSWQgPSB0aGlzLmNhcnRQcm9kdWN0LmNhcnRJZA0KICAgICAgcmVxdWVzdA0KICAgICAgICAuZGVsZXRlKCcvY2FydC8nICsgY0lkKQ0KICAgICAgICAudGhlbigocmVzKSA9PiB7DQogICAgICAgICAgaWYgKHJlcy5jb2RlID09ICcwJykgew0KICAgICAgICAgICAgLy8g5Yig6Zmk5oiQ5YqfDQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgICAgbWVzc2FnZTogcmVzLm1zZywNCiAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLA0KICAgICAgICAgICAgICBkdXJhdGlvbjogMTAwMA0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3JlbG9hZDInKQ0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfliKDpmaTlpLHotKXvvIHmnI3liqHlmajplJnor6/vvIEnKQ0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICAgICAgLmNhdGNoKChlcnIpID0+IHsNCiAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpDQogICAgICAgIH0pDQogICAgfSwNCiAgICB0b0RldGFpbHMoKSB7DQogICAgICAvLyDngrnlh7sgQ2FydEl0ZW0g57uE5Lu277yM6YCa6L+H6Lev55Sx5Lyg6YCS5ZWG5ZOBaWTnu5lEdGFpbHPnu4Tku7bvvIznhLblkI7lj5Hotbfor7fmsYLjgIINCiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsNCiAgICAgICAgcGF0aDogJy9kZXRhaWxzJywNCiAgICAgICAgcXVlcnk6IHsNCiAgICAgICAgICBpZDogdGhpcy5jYXJ0UHJvZHVjdC5wcm9kdWN0SWQNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9LA0KICAgIHRvQ2hlY2tvdXQoZSkgew0KICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKQ0KICAgICAgdGhpcy5jYXJ0UHJvZHVjdC5jb3VudCA9IDENCiAgICAgIGxldCBvYmogPSB7DQogICAgICAgIHRvdGFsOiAxLA0KICAgICAgICBtb25leTogdGhpcy5jYXJ0UHJvZHVjdC5wcm9kdWN0UHJpY2UgKiB0aGlzLmNhcnRQcm9kdWN0LmRpc2NvdW50LA0KICAgICAgICBjYXJ0UHJvZHVjdHM6IFt0aGlzLmNhcnRQcm9kdWN0XQ0KICAgICAgfQ0KICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgnY2hlY2tvdXQnLCBKU09OLnN0cmluZ2lmeShvYmopKQ0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9jaGVja291dCcpDQogICAgfQ0KICB9LA0KICBwcm9wczogew0KICAgIGNhcnRQcm9kdWN0OiB7DQogICAgICB0eXBlOiBPYmplY3QNCiAgICB9DQogIH0sDQogIGNyZWF0ZWQoKSB7DQogICAgdGhpcy5udW0gPSB0aGlzLmNhcnRQcm9kdWN0LmNvdW50DQogIH0NCn0NCg=="},{"version":3,"sources":["CartItem.vue"],"names":[],"mappings":";AA8CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CartItem.vue","sourceRoot":"src/views/cart","sourcesContent":["<template>\r\n  <el-row type=\"flex\" class=\"cart-item-bd\">\r\n    <el-col :span=\"5\">\r\n      <img :src=\"cartProduct.imgSrc\" alt=\"\" class=\"image\" />\r\n    </el-col>\r\n    <el-col :span=\"4\"> {{ cartProduct.productName }} </el-col>\r\n    <el-col :span=\"3\">￥{{ cartProduct.productPrice }}</el-col>\r\n    <el-col :span=\"5\">\r\n      <el-input-number\r\n        v-model=\"num\"\r\n        controls-position=\"right\"\r\n        style=\"width: 80%\"\r\n        @change=\"handleChange\"\r\n        :min=\"1\"\r\n        :max=\"999\"\r\n      ></el-input-number>\r\n    </el-col>\r\n    <el-col :span=\"3\"\r\n      >￥{{ (cartProduct.productPrice * this.num).toFixed(2) }}</el-col\r\n    >\r\n    <el-col :span=\"5\">\r\n      <el-popover placement=\"top\" width=\"160\" v-model=\"visible\">\r\n        <p>确定从收藏夹移出该商品吗？</p>\r\n        <div style=\"text-align: right; margin: 0\">\r\n          <el-button size=\"mini\" type=\"text\" @click=\"visible = false\"\r\n            >取消</el-button\r\n          >\r\n          <el-button type=\"primary\" size=\"mini\" @click=\"deleteCartItem\"\r\n            >确定</el-button\r\n          >\r\n        </div>\r\n      </el-popover>\r\n      <el-button @click=\"visible = true\" type=\"danger\" size=\"small\" plain\r\n        >删除</el-button\r\n      >\r\n      <el-button size=\"small\" type=\"primary\" @click=\"toDetails\" plain\r\n        >查看</el-button\r\n      >\r\n      <el-button size=\"small\" type=\"primary\" plain @click=\"toCheckout\"\r\n        >购买</el-button\r\n      >\r\n    </el-col>\r\n  </el-row>\r\n</template>\r\n\r\n<script>\r\nimport request from '../../utils/request'\r\nexport default {\r\n  data() {\r\n    return {\r\n      num: 1,\r\n      visible: false\r\n    }\r\n  },\r\n  methods: {\r\n    handleChange(value) {\r\n      request\r\n        .patch('/cart/' + this.cartProduct.cartId, {\r\n          count: value\r\n        })\r\n        .then((res) => {\r\n          // console.log('修改成功')\r\n        })\r\n        .catch((err) => {\r\n          console.log(err)\r\n        })\r\n      let price =\r\n        this.num * this.cartProduct.productPrice * this.cartProduct.discount\r\n      let discountAmount = this.num * this.cartProduct.productPrice\r\n      this.$emit(\r\n        'reload',\r\n        this.cartProduct.cartId,\r\n        this.cartProduct.productId,\r\n        value,\r\n        price,\r\n        discountAmount\r\n      )\r\n    },\r\n    deleteCartItem() {\r\n      this.visible = false\r\n      let cId = this.cartProduct.cartId\r\n      request\r\n        .delete('/cart/' + cId)\r\n        .then((res) => {\r\n          if (res.code == '0') {\r\n            // 删除成功\r\n            this.$message({\r\n              message: res.msg,\r\n              type: 'success',\r\n              duration: 1000\r\n            })\r\n            this.$emit('reload2')\r\n          } else {\r\n            this.$message.error('删除失败！服务器错误！')\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.log(err)\r\n        })\r\n    },\r\n    toDetails() {\r\n      // 点击 CartItem 组件，通过路由传递商品id给Dtails组件，然后发起请求。\r\n      this.$router.push({\r\n        path: '/details',\r\n        query: {\r\n          id: this.cartProduct.productId\r\n        }\r\n      })\r\n    },\r\n    toCheckout(e) {\r\n      e.stopPropagation()\r\n      this.cartProduct.count = 1\r\n      let obj = {\r\n        total: 1,\r\n        money: this.cartProduct.productPrice * this.cartProduct.discount,\r\n        cartProducts: [this.cartProduct]\r\n      }\r\n      sessionStorage.setItem('checkout', JSON.stringify(obj))\r\n      this.$router.push('/checkout')\r\n    }\r\n  },\r\n  props: {\r\n    cartProduct: {\r\n      type: Object\r\n    }\r\n  },\r\n  created() {\r\n    this.num = this.cartProduct.count\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.cart-item-bd {\r\n  padding: 10px;\r\n  border-bottom: 1px solid rgba(204, 204, 204, 0.5);\r\n  height: 150px;\r\n  line-height: 140px;\r\n  /* line-height: 100%; */\r\n}\r\n.image {\r\n  /* width: 70%; */\r\n  height: 80%;\r\n  margin: 5% 10%;\r\n  box-shadow: rgba(9, 30, 66, 0.25) 0px 4px 8px -2px,\r\n    rgba(9, 30, 66, 0.08) 0px 0px 0px 1px;\r\n}\r\n</style>"]}]}